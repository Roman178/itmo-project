<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./fixcarousel/glide.core.css" />
    <link rel="stylesheet" href="./fixcarousel/glide.theme.css" />
    <link rel="stylesheet" href="./fixcarousel/index.css" />
    <link rel="stylesheet" href="./pages/index.css" />
    <!-- <link rel="stylesheet" href="./pages/index.css" /> -->
    <title>Document</title>
  </head>
  <body>
    <div class="intro__carousel middle-carousel">
      <div class="middle-carousel__wrapper glide">
        <div class="glide__track" data-glide-el="track">
          <ul class="glide__slides"></ul>
        </div>
        <div class="glide__arrows" data-glide-el="controls">
          <button
            class="
              glide__arrow glide__arrow--left
              middle-carousel__arrow middle-carousel__arrow_type_prev
            "
            data-glide-dir="<"
          >
            <img src="./images/arrow-left.svg" alt="arrow prev" />
          </button>
          <button
            class="
              glide__arrow glide__arrow--right
              middle-carousel__arrow middle-carousel__arrow_type_next
            "
            data-glide-dir=">"
          >
            <img src="./images/arrow-right.svg" alt="arrow next" />
          </button>
        </div>
        <div
          class="glide__bullets middle-carousel__bullets"
          data-glide-el="controls[nav]"
        ></div>
      </div>
    </div>
    <div class="publications__carousel large-carousel">
      <div class="large-carousel__wrapper glide">
        <div class="glide__track" data-glide-el="track">
          <ul class="glide__slides"></ul>
        </div>
        <div class="glide__arrows" data-glide-el="controls">
          <button
            class="
              glide__arrow glide__arrow--left
              large-carousel__arrow large-carousel__arrow_type_prev
            "
            data-glide-dir="<"
          >
            <img src="./images/arrow-left.svg" alt="arrow prev" />
          </button>
          <button
            class="
              glide__arrow glide__arrow--right
              large-carousel__arrow large-carousel__arrow_type_next
            "
            data-glide-dir=">"
          >
            <img src="./images/arrow-right.svg" alt="arrow next" />
          </button>
        </div>
        <div
          class="glide__bullets large-carousel__bullets"
          data-glide-el="controls[nav]"
        ></div>
      </div>
    </div>
    <!--  -->
    <template id="middle-carousel-card">
      <div class="middle-carousel__card">
        <div class="middle-carousel__card-content">
          <p class="middle-carousel__card-date"></p>
          <h3 class="middle-carousel__card-title"></h3>
          <div class="middle-carousel__card-line"></div>
          <p class="middle-carousel__card-text"></p>
        </div>
        <img
          class="middle-carousel__card-pin"
          src="./images/pin.svg"
          alt="Pin"
        />
      </div>
    </template>

    <template id="publications-card">
      <div class="publications__card">
        <div class="publications__card-content">
          <img
            class="publications__card-image"
            src="./images/Publication/publication_Peregreen–modular database for efficient storage of historical tim….png"
            alt="Иллюстрация к статье"
          />
          <div class="publications__card-text-content">
            <h3 class="publications__card-title">
              Peregreen–modular database for efficient storage of historical
              tim…
            </h3>
            <p class="publications__card-authors">
              Alexander Visheratin, Alexey Struckov, Semen Yufa, Alexey Muratov,
              Denis Nasonov, Nikolay B…
            </p>
            <p class="publications__card-article">
              The rapid development of scientific and industrial areas, which
              rely on time series data processing, raises the demand for storage
              that would be able to process tens and hundreds of terabytes of
              data efficiently. And by efficiency, one should understand not
              only the speed of data processing operations execution but als…
            </p>
          </div>
        </div>
        <div class="publications__card-nav-block">
          <div class="publications__card-link-holder">
            <a class="publications__card-learn-more-link" href=""
              >Читать полностью
              <img
                class="publications__card-learn-more-arrow"
                src="./images/learn-more-arrow.svg"
                alt=""
            /></a>
          </div>
          <div class="publications__card-share-popup" id="share-popup">
            <div class="publications__card-share-group">
              <a class="publications__card-share-link" href="#">
                <img
                  class="publications__card-share-icon"
                  src="./images/Share-social-icons/VK.svg"
                  alt="VK"
                />
              </a>
              <a class="publications__card-share-link" href="#">
                <img
                  class="publications__card-share-icon"
                  src="./images/Share-social-icons/Facebook.svg"
                  alt="fb"
                />
              </a>
              <a class="publications__card-share-link" href="#">
                <img
                  class="publications__card-share-icon"
                  src="./images/Share-social-icons/Telegram.svg"
                  alt="tg"
                />
              </a>
              <a class="publications__card-share-link" href="#">
                <img
                  class="publications__card-share-icon"
                  src="./images/Share-social-icons/Insta.svg"
                  alt="ig"
                />
              </a>
              <a class="publications__card-share-link" href="#">
                <img
                  class="publications__card-share-icon"
                  src="./images/Share-social-icons/You Tube.svg"
                  alt="YT"
                />
              </a>
            </div>
            <div class="publications__card-share-arrow"></div>
          </div>
          <div class="publications__card-share">
            <button
              class="publications__card-share-button"
              id="share-button"
            ></button>
          </div>
        </div>
      </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide"></script>
    <script src="./js/introData.js"></script>
    <script>
      const introCarousel = document.querySelector(".intro__carousel");
      const introSlidesBox = introCarousel.querySelector(".glide__slides");
      const introCard = document
        .querySelector("#middle-carousel-card")
        .content.querySelector(".middle-carousel__card");
      const introSlide = document.createElement("li");
      introSlide.classList.add("glide__slide", "middle-carousel__slide");

      const publicationsCarousel = document.querySelector(
        ".publications__carousel"
      );
      const publicationsSlidesBox =
        publicationsCarousel.querySelector(".glide__slides");
      const publicationsCard = document
        .querySelector("#middle-carousel-card")
        .content.querySelector(".middle-carousel__card");
      const publicationsSlide = document.createElement("li");
      publicationsSlide.classList.add("glide__slide", "middle-carousel__slide");

      function appendCardsInSlide(numCards, slide, card) {
        for (let i = 0; i < numCards; i++) {
          slide.append(card.cloneNode(true));
        }
      }

      function appendSlidesInCarousel(numSlides, slidesBox, slide, carousel) {
        for (let j = 0; j < numSlides; j++) {
          slidesBox.append(slide.cloneNode(true));
          const bullet = document.createElement("button");
          bullet.dataset.glideDir = "=" + j;
          bullet.classList.add("glide__bullet");
          carousel.querySelector(".glide__bullets").append(bullet);
        }
      }

      function clearLastSlide(slidesBox, cardSelector, data) {
        const startingLengthOfCards =
          slidesBox.querySelectorAll(cardSelector).length;

        for (let k = data.length; k < startingLengthOfCards; k++) {
          slidesBox
            .querySelector(
              `.glide__slide:last-of-type ${cardSelector}:last-of-type`
            )
            .remove();
        }
      }

      appendCardsInSlide(3, introSlide, introCard);
      appendSlidesInCarousel(4, introSlidesBox, introSlide, introCarousel);
      clearLastSlide(introSlidesBox, ".middle-carousel__card", introData);

      const appendedCards = introCarousel.querySelectorAll(
        ".middle-carousel__card"
      );

      appendedCards.forEach((card, i) => {
        card.querySelector(".middle-carousel__card-date").textContent =
          introData[i].date;
        card.querySelector(".middle-carousel__card-title").textContent =
          introData[i].title;
        card.querySelector(".middle-carousel__card-text").textContent =
          introData[i].text;
      });

      new Glide(".intro__carousel .middle-carousel__wrapper").mount();
    </script>
  </body>
</html>
